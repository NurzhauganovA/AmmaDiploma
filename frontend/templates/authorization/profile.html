{% extends 'main/base.html' %}
{% load static %}

{% block links %}
    <link rel="stylesheet" href="{% static 'authorization/css/profile.css' %}">
{% endblock %}

{% block title %} Amma - Profile {% endblock %}

{% block page_title %} Profile {% endblock %}

{% block content %}
    <div class="section_container">
        <div class="wrapper">
            <div class="main_profile_redactor_container">

                <div class="title_main_profile_redactor_block">
                    <h1>Overview</h1>
                    <p>Home - Account</p>
                </div>

                <div class="information_main_profile_redactor_block">
                    <div class="main_information_profile_block">
                        {% if not profile.photo_avatar %}
                            <div class="image_main_information_block" style="background-image: url('https://images.unsplash.com/photo-1580489944761-15a19d654956?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=461&q=80');"></div>
                        {% else %}
                            <div class="image_main_information_block" style="background-image: url('{{ profile.photo_avatar.url }}');"></div>
                        {% endif %}
                        <div class="user_information_profile_block">
                            <div class="fullname_user_information_block">
                                {% if profile.user.full_name %}
                                    <h1>{{ profile.user.full_name }}</h1>
                                {% else %}
                                    <h1>Anonymous</h1>
                                {% endif %}
                                <i>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#009ef7" class="bi bi-patch-check-fill" viewBox="0 0 16 16">
                                        <path d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z"></path>
                                    </svg>
                                </i>
                            </div>
                            <div class="additional_user_information_block">
                                <div class="geolocation_user_information_block">
                                    <i>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#474761" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                            <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"></path>
                                        </svg>
                                    </i>
                                    <h1>{{ profile.country }}</h1>
                                </div>
                                <div class="mail_user_information_block">
                                    <i>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#474761" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                                             <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"></path>
                                        </svg>
                                    </i>
                                    <h1>{{ profile.user.email }}</h1>
                                </div>
                            </div>
                            <div class="balance_user_information_block">
                                <div class="check_balance_user_block">
                                    <div class="title_check_balance_user_block">
                                        <i>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="#A46A90" class="bi bi-arrow-up-short" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"></path>
                                            </svg>
                                        </i>
                                        <h1>{{ articles.count }}</h1>
                                    </div>
                                    <p>Article</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="completion_information_profile_block">
                        <a href="{% url 'blog' %}" class="replenish_balance_user_block">
                            Create Article
                        </a>
                        <div class="percentage_completion_user_block">
                            <div class="title_percentage_completion_block">
                                <h1>Profile Completion</h1>
                                <p>{{ completion_percentage }}%</p>
                            </div>
                            <div class="background_range_question_block">
                                {% if empty_fields == 0 %}
                                    <div class="range_question_value_block" style="width: 100%;"></div>
                                {% else %}
                                    <div class="range_question_value_block" style="width: {{ completion_percentage }}%;"></div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="detail_blocks_content">
                    <div class="more_detail_block active tablink" id="defaultOpen" onclick="openPage('Profile', this, '#A46A90')">Profile details</div>
                    <div class="more_detail_block active tablink" onclick="openPage('Pregnancy', this, '#A46A90')">Pregnancy details</div>
                    <div class="more_detail_block tablink" onclick="openPage('Questionnaire', this, '#A46A90')">Questionnaire details</div>
                    <div class="more_detail_block tablink" onclick="openPage('articles', this, '#A46A90')">My articles</div>
                </div>

                <div class="profile_detail_profile_redactor_block tabcontent" id="Profile">
                    <div class="title_profile_detail_redactor_block">
                        <h1>Profile Details</h1>
                        <a href="{% url 'edit_profile' %}">Edit Profile</a>
                    </div>
                    <div class="main_information_profile_detail_block">
                        <div class="profile_detail_info">
                            <p>Full Name</p>
                            <h1>{{ profile.user.full_name }}</h1>
                        </div>
                        <div class="profile_detail_info">
                            <p>Email</p>
                            <h1>{{ profile.user.email }}</h1>
                        </div>
                        <div class="profile_detail_info">
                            <p>Mobile phone</p>
                            <h1>{{ profile.user.mobile_phone }}</h1>
                        </div>
                        <div class="profile_detail_info">
                            <p>Country</p>
                            <h1>{{ profile.country }}</h1>
                        </div>
                    </div>
                </div>

                <div class="profile_detail_profile_redactor_block tabcontent" id="Pregnancy">
                    <div class="title_profile_detail_redactor_block">
                        <h1>Pregnancy Details</h1>
                        <a href="{% url 'delete_pregnancy_progress' %}">Delete current progress</a>
                    </div>
                    <div class="main_information_profile_detail_block">
                        <div class="pregnancy-details-body">
                            <div class="pregnancy-week">
                                <p><strong>Current Week of Pregnancy: </strong><span>{{ week_number }}</span></p>
                            </div>
                            <div class="pregnancy-period">
                                <p><strong>Start Date of Pregnancy: </strong><span>{{ start_date|date:"Y-m-d" }}</span></p>
                            </div>
                            <div class="pregnancy-due-date">
                                <p><strong>Due Date: </strong><span>{{ due_date|date:"Y-m-d" }}</span></p>
                            </div>
                            <div class="pregnancy-progress-bar">
                                <p><strong>Pregnancy Progress: </strong><span>{{ pregnancy_progress }}%</span></p>
                                <div class="progress-bar">
                                    <div class="progress" style="width: {{ pregnancy_progress }}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="profile_detail_profile_redactor_block tabcontent" id="Questionnaire">
                    <div class="title_profile_detail_redactor_block">
                        <h1>Questionnaire Details</h1>
                        <a href="{% url 'base_questionnaire' %}">Pass again</a>
                    </div>
                    <div class="main_information_profile_detail_block">
                        {% for questions in questionnaire_result.answers.all %}
                            <div class="questionnaire_info">
                                <p>{{ questions.question }}</p>
                                {% if questions.text %}
                                    <h1>{{ questions.text }}</h1>
                                {% else %}
                                    <h1>Not answered</h1>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                </div>

                {% if articles.count > 0 %}
                    <div class="my_articles_profile_block tabcontent" id="articles">
                        <div class="title_my_articles_profile_block">
                            <h1>My Articles</h1>
                            <a href="{% url 'blog' %}">Create Article</a>
                        </div>
                        <ul class="list_my_articles_profile_block">
                            {% for article in articles %}
                                <li class="article_profile_block">
                                    <div class="main_information_article_profile_block">
                                        <div class="cover_image_article_profile_block" style="background-image: url('{{ article.image.url }}')"></div>
                                        <div class="title_article_profile_block">
                                            <h1>{{ article.title }}</h1>
                                            <p>{{ article.created_date|date:"d M Y" }}</p>
                                        </div>
                                    </div>
                                    <div class="description_article_profile_block">
                                        <p>{{ article.summary }}</p>
                                    </div>
                                    <div class="button_article_profile_block">
                                        <a href="{% url 'blog-detail' article.id %}">Read More</a>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}

            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}

    <script>
        function openPage(pageName, elmnt, color) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("more_detail_block");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(pageName).style.display = "block";
            elmnt.className += " active";
        }

        document.getElementById("defaultOpen").click();
    </script>

{% endblock %}